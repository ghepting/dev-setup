#!/usr/bin/env zsh

ZSHRC_FILE="$HOME/.zshrc"

# colors
RED="\e[31m"
GREEN="\e[32m"
YELLOW="\e[33m"
BLUE="\e[34m"
MAGENTA="\e[35m"
CYAN="\e[36m"
WHITE="\e[37m"
NC="\e[0m" # No Color (Reset)

RESTART_REQUIRED=false

CONFIG_DIR="${HOME}/.config"
CONFIG_FILE="${CONFIG_DIR}/dev-setup.conf"

# create config directory if it doesn't exist
if [ ! -d "$CONFIG_DIR" ]
then
  mkdir -p "$CONFIG_DIR"
fi

# copy config file to ~/.config/dev-setup.conf if it doesn't exist
if [ ! -f "$CONFIG_FILE" ]
then
  cp "./dev-setup.conf" "$CONFIG_FILE"
fi

# source utility functions
source "./lib/brew.sh"
source "./lib/ruby.sh"
source "./lib/python.sh"
source "./lib/node.sh"
source "./lib/gemini.sh"
source "./lib/vim_tmux.sh"
source "./lib/1password.sh"
source "./lib/dotfiles.sh"
source "./lib/docker.sh"
source "./lib/app_store.sh"
source "./lib/claude.sh"
source "./lib/editor.sh"
source "./lib/iterm.sh"
source "./lib/postman.sh"

# install homebrew
install_homebrew

# install google drive
if [ ! -d "/Applications/Google Drive.app" ]
then
  brew install --cask google-drive
  open /Applications/Google\ Drive.app
  read "?Press [Enter] after logging in to Google Drive..."
fi

# google drive dotfiles
symlink_google_drive_dotfiles
symlink_antigravity_config

# add homebrew to path
install_homebrew_path

# add ghostty to path
install_ghostty_path

# homebrew and formulae
install_homebrew_formulae

# iTerm2 colors
setup_iterm_colors

# configure Antigravity as default editor
configure_editor
install_antigravity_extensions
update_antigravity_extensions_list

# docker
setup_docker

# ruby and rbenv
install_rbenv_and_ruby

# python and pyenv
install_pyenv_and_python

# node/npm, and nvm
install_nvm_and_node

# vim & tmux
setup_vim_tmux_config

# 1password and SSH agent
setup_1password

# gemini CLI
install_gemini_cli

# claude
install_claude_code_cli

# postman CLI
install_postman_cli

# app store apps
install_mas_apps

echo -e "${GREEN}Dev setup completed successfully${NC}"
if $RESTART_REQUIRED
then
  echo -e "${YELLOW}You may need to restart your terminal${NC}"
fi
exit 0
