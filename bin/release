#!/usr/bin/env zsh

# Usage: ./bin/release <new-version>
VERSION=$1

if [[ -z "$VERSION" ]]; then
  echo "Usage: ./bin/release <version> (e.g. 1.1.0)"
  exit 1
fi

# update VERSION file
echo "$VERSION" > VERSION

# commit, tag, and push to origin
git add VERSION
git commit -m "chore: release v$VERSION"
git tag -a "v$VERSION" -m "Release v$VERSION"
git push origin main --tags

echo "Released v$VERSION"
